{"ast":null,"code":"import _slicedToArray from\"/mnt/Datengrab/python/Zero-tier/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import{useHistory}from\"react-router-dom\";import{useLocalStorage}from\"react-use\";import{TextField,Button,Dialog,DialogActions,DialogContent,DialogTitle,Snackbar}from\"@material-ui/core\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function LogInUser(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),snackbarOpen=_useState4[0],setSnackbarOpen=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),username=_useState6[0],setUsername=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useLocalStorage=useLocalStorage(\"user\",null),_useLocalStorage2=_slicedToArray(_useLocalStorage,2),setLoggedInUsername=_useLocalStorage2[1];var _useLocalStorage3=useLocalStorage(\"loggedIn\",false),_useLocalStorage4=_slicedToArray(_useLocalStorage3,2),setLoggedIn=_useLocalStorage4[1];var _useLocalStorage5=useLocalStorage(\"token\",null),_useLocalStorage6=_slicedToArray(_useLocalStorage5,2),setToken=_useLocalStorage6[1];var history=useHistory();var handleClickOpen=function handleClickOpen(){setOpen(true);};var handleClose=function handleClose(){setOpen(false);setSnackbarOpen(false);};var handleKeyPress=function handleKeyPress(event){var key=event.key;if(event.altKey||event.ctrlKey||event.metaKey||event.shiftKey){return;}if(key===\"Enter\"){LogIn();}};var LogIn=function LogIn(){if(!username||!password){return;}axios.post(\"/auth/login\",{username:username,password:password}).then(function(response){if(response.data.data.role===\"admin\"){setLoggedIn(true);setToken(response.data.data.token);handleClose();history.go(0);}else{setLoggedIn(\"user\");setLoggedInUsername(username);setToken(response.data.data.token);handleClose();history.go(0);}}).catch(function(error){setPassword(\"\");setSnackbarOpen(true);console.error(error);});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleClickOpen,color:\"primary\",variant:\"contained\",children:\"Log In\"}),/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,onKeyPress:handleKeyPress,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Log In\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{autoFocus:true,value:username,onChange:function onChange(e){setUsername(e.target.value);},margin:\"dense\",label:\"username\",type:\"username\",fullWidth:true}),/*#__PURE__*/_jsx(TextField,{value:password,onChange:function onChange(e){setPassword(e.target.value);},margin:\"dense\",label:\"password\",type:\"password\",fullWidth:true})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"primary\",children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:LogIn,color:\"primary\",children:\"Log In\"})]})]}),/*#__PURE__*/_jsx(Snackbar,{open:snackbarOpen,anchorOrigin:{vertical:\"top\",horizontal:\"center\"},message:\"Invalid username or password\"})]});}export default LogInUser;","map":{"version":3,"names":["useState","useHistory","useLocalStorage","TextField","Button","Dialog","DialogActions","DialogContent","DialogTitle","Snackbar","axios","LogInUser","open","setOpen","snackbarOpen","setSnackbarOpen","username","setUsername","password","setPassword","setLoggedInUsername","setLoggedIn","setToken","history","handleClickOpen","handleClose","handleKeyPress","event","key","altKey","ctrlKey","metaKey","shiftKey","LogIn","post","then","response","data","role","token","go","catch","error","console","e","target","value","vertical","horizontal"],"sources":["/mnt/Datengrab/python/Zero-tier/frontend/src/components/LogIn/components/LogInUser/LogInUser.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useLocalStorage } from \"react-use\";\nimport {\n  TextField,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Snackbar,\n} from \"@material-ui/core\";\n\nimport axios from \"axios\";\n\nfunction LogInUser() {\n  const [open, setOpen] = useState(false);\n  const [snackbarOpen, setSnackbarOpen] = useState(false);\n\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  \n  const [, setLoggedInUsername] = useLocalStorage(\"user\", null);\n  const [, setLoggedIn] = useLocalStorage(\"loggedIn\", false);\n  const [, setToken] = useLocalStorage(\"token\", null);\n  \n  const history = useHistory();\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n    setSnackbarOpen(false);\n  };\n\n  const handleKeyPress = (event) => {\n    const key = event.key;\n\n    if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {\n      return;\n    }\n\n    if (key === \"Enter\") {\n      LogIn();\n    }\n  };\n\n  const LogIn = () => {\n    if (!username || !password) {\n      return;\n    }\n\n    axios\n      .post(\"/auth/login\", {\n        username: username,\n        password: password,\n      })\n      .then(function (response) {\n        if (response.data.data.role === \"admin\") {\n          setLoggedIn(true);\n          setToken(response.data.data.token);\n          handleClose();\n          history.go(0); \n        }\n        else {\n          setLoggedIn(\"user\");\n          setLoggedInUsername(username)\n          setToken(response.data.data.token);\n          handleClose();\n          history.go(0); \n        }\n      })\n      .catch(function (error) {\n        setPassword(\"\");\n        setSnackbarOpen(true);\n        console.error(error);\n      });\n  };\n\n  return (\n    <>\n      <Button onClick={handleClickOpen} color=\"primary\" variant=\"contained\">\n        Log In\n      </Button>\n      <Dialog open={open} onClose={handleClose} onKeyPress={handleKeyPress}>\n        <DialogTitle>Log In</DialogTitle>\n        <DialogContent>\n          <TextField\n            autoFocus\n            value={username}\n            onChange={(e) => {\n              setUsername(e.target.value);\n            }}\n            margin=\"dense\"\n            label=\"username\"\n            type=\"username\"\n            fullWidth\n          />\n          <TextField\n            value={password}\n            onChange={(e) => {\n              setPassword(e.target.value);\n            }}\n            margin=\"dense\"\n            label=\"password\"\n            type=\"password\"\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            Cancel\n          </Button>\n          <Button onClick={LogIn} color=\"primary\">\n            Log In\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <Snackbar\n        open={snackbarOpen}\n        anchorOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\",\n        }}\n        message=\"Invalid username or password\"\n      />\n    </>\n  );\n}\n\nexport default LogInUser;\n"],"mappings":"8HAAA,OAASA,QAAT,KAAyB,OAAzB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,eAAT,KAAgC,WAAhC,CACA,OACEC,SADF,CAEEC,MAFF,CAGEC,MAHF,CAIEC,aAJF,CAKEC,aALF,CAMEC,WANF,CAOEC,QAPF,KAQO,mBARP,CAUA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,6IAEA,QAASC,CAAAA,SAAT,EAAqB,CACnB,cAAwBX,QAAQ,CAAC,KAAD,CAAhC,wCAAOY,IAAP,eAAaC,OAAb,eACA,eAAwCb,QAAQ,CAAC,KAAD,CAAhD,yCAAOc,YAAP,eAAqBC,eAArB,eAEA,eAAgCf,QAAQ,CAAC,EAAD,CAAxC,yCAAOgB,QAAP,eAAiBC,WAAjB,eACA,eAAgCjB,QAAQ,CAAC,EAAD,CAAxC,yCAAOkB,QAAP,eAAiBC,WAAjB,eAEA,qBAAgCjB,eAAe,CAAC,MAAD,CAAS,IAAT,CAA/C,sDAASkB,mBAAT,sBACA,sBAAwBlB,eAAe,CAAC,UAAD,CAAa,KAAb,CAAvC,uDAASmB,WAAT,sBACA,sBAAqBnB,eAAe,CAAC,OAAD,CAAU,IAAV,CAApC,uDAASoB,QAAT,sBAEA,GAAMC,CAAAA,OAAO,CAAGtB,UAAU,EAA1B,CAEA,GAAMuB,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5BX,OAAO,CAAC,IAAD,CAAP,CACD,CAFD,CAIA,GAAMY,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxBZ,OAAO,CAAC,KAAD,CAAP,CACAE,eAAe,CAAC,KAAD,CAAf,CACD,CAHD,CAKA,GAAMW,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,KAAD,CAAW,CAChC,GAAMC,CAAAA,GAAG,CAAGD,KAAK,CAACC,GAAlB,CAEA,GAAID,KAAK,CAACE,MAAN,EAAgBF,KAAK,CAACG,OAAtB,EAAiCH,KAAK,CAACI,OAAvC,EAAkDJ,KAAK,CAACK,QAA5D,CAAsE,CACpE,OACD,CAED,GAAIJ,GAAG,GAAK,OAAZ,CAAqB,CACnBK,KAAK,GACN,CACF,CAVD,CAYA,GAAMA,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,CAClB,GAAI,CAACjB,QAAD,EAAa,CAACE,QAAlB,CAA4B,CAC1B,OACD,CAEDR,KAAK,CACFwB,IADH,CACQ,aADR,CACuB,CACnBlB,QAAQ,CAAEA,QADS,CAEnBE,QAAQ,CAAEA,QAFS,CADvB,EAKGiB,IALH,CAKQ,SAAUC,QAAV,CAAoB,CACxB,GAAIA,QAAQ,CAACC,IAAT,CAAcA,IAAd,CAAmBC,IAAnB,GAA4B,OAAhC,CAAyC,CACvCjB,WAAW,CAAC,IAAD,CAAX,CACAC,QAAQ,CAACc,QAAQ,CAACC,IAAT,CAAcA,IAAd,CAAmBE,KAApB,CAAR,CACAd,WAAW,GACXF,OAAO,CAACiB,EAAR,CAAW,CAAX,EACD,CALD,IAMK,CACHnB,WAAW,CAAC,MAAD,CAAX,CACAD,mBAAmB,CAACJ,QAAD,CAAnB,CACAM,QAAQ,CAACc,QAAQ,CAACC,IAAT,CAAcA,IAAd,CAAmBE,KAApB,CAAR,CACAd,WAAW,GACXF,OAAO,CAACiB,EAAR,CAAW,CAAX,EACD,CACF,CAnBH,EAoBGC,KApBH,CAoBS,SAAUC,KAAV,CAAiB,CACtBvB,WAAW,CAAC,EAAD,CAAX,CACAJ,eAAe,CAAC,IAAD,CAAf,CACA4B,OAAO,CAACD,KAAR,CAAcA,KAAd,EACD,CAxBH,EAyBD,CA9BD,CAgCA,mBACE,wCACE,KAAC,MAAD,EAAQ,OAAO,CAAElB,eAAjB,CAAkC,KAAK,CAAC,SAAxC,CAAkD,OAAO,CAAC,WAA1D,oBADF,cAIE,MAAC,MAAD,EAAQ,IAAI,CAAEZ,IAAd,CAAoB,OAAO,CAAEa,WAA7B,CAA0C,UAAU,CAAEC,cAAtD,wBACE,KAAC,WAAD,qBADF,cAEE,MAAC,aAAD,yBACE,KAAC,SAAD,EACE,SAAS,KADX,CAEE,KAAK,CAAEV,QAFT,CAGE,QAAQ,CAAE,kBAAC4B,CAAD,CAAO,CACf3B,WAAW,CAAC2B,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX,CACD,CALH,CAME,MAAM,CAAC,OANT,CAOE,KAAK,CAAC,UAPR,CAQE,IAAI,CAAC,UARP,CASE,SAAS,KATX,EADF,cAYE,KAAC,SAAD,EACE,KAAK,CAAE5B,QADT,CAEE,QAAQ,CAAE,kBAAC0B,CAAD,CAAO,CACfzB,WAAW,CAACyB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX,CACD,CAJH,CAKE,MAAM,CAAC,OALT,CAME,KAAK,CAAC,UANR,CAOE,IAAI,CAAC,UAPP,CAQE,SAAS,KARX,EAZF,GAFF,cAyBE,MAAC,aAAD,yBACE,KAAC,MAAD,EAAQ,OAAO,CAAErB,WAAjB,CAA8B,KAAK,CAAC,SAApC,oBADF,cAIE,KAAC,MAAD,EAAQ,OAAO,CAAEQ,KAAjB,CAAwB,KAAK,CAAC,SAA9B,oBAJF,GAzBF,GAJF,cAsCE,KAAC,QAAD,EACE,IAAI,CAAEnB,YADR,CAEE,YAAY,CAAE,CACZiC,QAAQ,CAAE,KADE,CAEZC,UAAU,CAAE,QAFA,CAFhB,CAME,OAAO,CAAC,8BANV,EAtCF,GADF,CAiDD,CAED,cAAerC,CAAAA,SAAf"},"metadata":{},"sourceType":"module"}