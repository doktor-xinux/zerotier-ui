{"ast":null,"code":"import _asyncToGenerator from\"/mnt/Datengrab/python/Zero-tier/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/mnt/Datengrab/python/Zero-tier/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/mnt/Datengrab/python/Zero-tier/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{Checkbox,FormControlLabel,Grid,IconButton,Input,Paper,Select,Typography}from\"@material-ui/core\";import DeleteIcon from\"@material-ui/icons/Delete\";import{useEffect,useState}from\"react\";import{useDebounce}from\"react-use\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Tag(_ref){var member=_ref.member,tagName=_ref.tagName,tagDetail=_ref.tagDetail,handleChange=_ref.handleChange;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),tagValue=_useState2[0],setTagValue=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),tagChangedByUser=_useState4[0],setTagChangedByUser=_useState4[1];useEffect(function(){var tagIndex=member[\"config\"][\"tags\"].findIndex(function(item){return item[0]===tagDetail[\"id\"];});var value=\"\";if(tagIndex!==-1){value=member[\"config\"][\"tags\"][tagIndex][1];}value=value!==false?value:\"\";setTagValue(value);},[member,tagDetail]);useDebounce(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var value,event;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(tagChangedByUser){value=tagValue===\"\"?\"\":parseInt(tagValue);event={target:{value:value}};handleChange(member,\"config\",\"tags\",\"tagChange\",tagDetail[\"id\"])(event);}setTagChangedByUser(false);case 2:case\"end\":return _context.stop();}}},_callee);})),500,[tagValue]);var handleSelectChange=function handleSelectChange(event){var newValue=event.target.value;setTagChangedByUser(true);setTagValue(newValue);};var handleFlagChange=function handleFlagChange(value){return function(event){var newValue;var oldValue;if(tagValue===\"\"){oldValue=0;}else{oldValue=tagValue;}if(event.target.checked){newValue=oldValue+value;}else{newValue=oldValue-value;}setTagChangedByUser(true);setTagValue(newValue);};};var handleInputChange=function handleInputChange(event){var value=event.target.value;if(/^(|0|[1-9]\\d*)$/.test(value)){value=value===\"\"?value:parseInt(value);}else{value=0;}setTagChangedByUser(true);setTagValue(value);};var clearTag=function clearTag(event){setTagChangedByUser(true);setTagValue(\"\");};return/*#__PURE__*/_jsx(Paper,{style:{padding:20},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",color:tagValue===\"\"?\"error\":\"primary\",children:[tagName,tagValue===\"\"?\"\":/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"delete\",onClick:clearTag,children:/*#__PURE__*/_jsx(DeleteIcon,{})})]})}),/*#__PURE__*/_jsxs(Grid,{container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsxs(Select,{native:true,value:tagValue,onChange:handleSelectChange,displayEmpty:true,style:{minWidth:100},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"--\"}),Object.entries(tagDetail[\"enums\"]).map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),enumKey=_ref4[0],enumValue=_ref4[1];return/*#__PURE__*/_jsx(\"option\",{value:enumValue,children:enumKey},enumKey);}),Object.values(tagDetail[\"enums\"]).length===0&&tagValue!==\"\"?/*#__PURE__*/_jsx(\"option\",{value:tagValue,children:\"(no enums)\"}):\"\",Object.values(tagDetail[\"enums\"]).length!==0&&!Object.values(tagDetail[\"enums\"]).includes(tagValue)&&tagValue!==\"\"?/*#__PURE__*/_jsx(\"option\",{value:tagValue,children:\"(custom)\"}):\"\"]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(Input,{value:tagValue,onChange:handleInputChange,placeholder:\"Tag Value\"})})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:Object.entries(tagDetail[\"flags\"]).map(function(_ref5){var _ref6=_slicedToArray(_ref5,2),flagKey=_ref6[0],flagValue=_ref6[1];return/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:(tagValue&flagValue)===flagValue,onChange:handleFlagChange(flagValue),color:\"primary\"}),label:flagKey},\"flag-\"+flagKey);})})]})});}export default Tag;","map":{"version":3,"names":["Checkbox","FormControlLabel","Grid","IconButton","Input","Paper","Select","Typography","DeleteIcon","useEffect","useState","useDebounce","Tag","member","tagName","tagDetail","handleChange","tagValue","setTagValue","tagChangedByUser","setTagChangedByUser","tagIndex","findIndex","item","value","parseInt","event","target","handleSelectChange","newValue","handleFlagChange","oldValue","checked","handleInputChange","test","clearTag","padding","minWidth","Object","entries","map","enumKey","enumValue","values","length","includes","flagKey","flagValue"],"sources":["/mnt/Datengrab/python/Zero-tier/frontend/src/components/NetworkMembers/components/MemberSettings/components/Tag/Tag.jsx"],"sourcesContent":["import {\n  Checkbox,\n  FormControlLabel,\n  Grid,\n  IconButton,\n  Input,\n  Paper,\n  Select,\n  Typography,\n} from \"@material-ui/core\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport { useEffect, useState } from \"react\";\nimport { useDebounce } from \"react-use\";\n\nfunction Tag({ member, tagName, tagDetail, handleChange }) {\n  const [tagValue, setTagValue] = useState(\"\");\n  const [tagChangedByUser, setTagChangedByUser] = useState(false);\n\n  useEffect(() => {\n    let tagIndex = member[\"config\"][\"tags\"].findIndex((item) => {\n      return item[0] === tagDetail[\"id\"];\n    });\n    let value = \"\";\n    if (tagIndex !== -1) {\n      value = member[\"config\"][\"tags\"][tagIndex][1];\n    }\n    value = value !== false ? value : \"\";\n    setTagValue(value);\n  }, [member, tagDetail]);\n\n  useDebounce(\n    async () => {\n      if (tagChangedByUser) {\n        let value = tagValue === \"\" ? \"\" : parseInt(tagValue);\n        let event = { target: { value: value } };\n        handleChange(\n          member,\n          \"config\",\n          \"tags\",\n          \"tagChange\",\n          tagDetail[\"id\"]\n        )(event);\n      }\n      setTagChangedByUser(false);\n    },\n    500,\n    [tagValue]\n  );\n\n  const handleSelectChange = (event) => {\n    let newValue = event.target.value;\n    setTagChangedByUser(true);\n    setTagValue(newValue);\n  };\n\n  const handleFlagChange = (value) => (event) => {\n    let newValue;\n    let oldValue;\n\n    if (tagValue === \"\") {\n      oldValue = 0;\n    } else {\n      oldValue = tagValue;\n    }\n\n    if (event.target.checked) {\n      newValue = oldValue + value;\n    } else {\n      newValue = oldValue - value;\n    }\n    setTagChangedByUser(true);\n    setTagValue(newValue);\n  };\n\n  const handleInputChange = (event) => {\n    let value = event.target.value;\n    if (/^(|0|[1-9]\\d*)$/.test(value)) {\n      value = value === \"\" ? value : parseInt(value);\n    } else {\n      value = 0;\n    }\n    setTagChangedByUser(true);\n    setTagValue(value);\n  };\n\n  const clearTag = (event) => {\n    setTagChangedByUser(true);\n    setTagValue(\"\");\n  };\n\n  return (\n    <Paper style={{ padding: 20 }}>\n      <Grid container spacing={2}>\n        <Grid item xs={12}>\n          <Typography\n            variant=\"h6\"\n            color={tagValue === \"\" ? \"error\" : \"primary\"}\n          >\n            {tagName}\n            {tagValue === \"\" ? (\n              \"\"\n            ) : (\n              <IconButton aria-label=\"delete\" onClick={clearTag}>\n                <DeleteIcon />\n              </IconButton>\n            )}\n          </Typography>\n        </Grid>\n        <Grid container>\n          <Grid item xs={6}>\n            <Select\n              native\n              value={tagValue}\n              onChange={handleSelectChange}\n              displayEmpty\n              style={{ minWidth: 100 }}\n            >\n              <option value=\"\">--</option>\n              {Object.entries(tagDetail[\"enums\"]).map(\n                ([enumKey, enumValue]) => (\n                  <option key={enumKey} value={enumValue}>\n                    {enumKey}\n                  </option>\n                )\n              )}\n              {Object.values(tagDetail[\"enums\"]).length === 0 &&\n              tagValue !== \"\" ? (\n                <option value={tagValue}>(no enums)</option>\n              ) : (\n                \"\"\n              )}\n              {Object.values(tagDetail[\"enums\"]).length !== 0 &&\n              !Object.values(tagDetail[\"enums\"]).includes(tagValue) &&\n              tagValue !== \"\" ? (\n                <option value={tagValue}>(custom)</option>\n              ) : (\n                \"\"\n              )}\n            </Select>\n          </Grid>\n          <Grid item xs={6}>\n            <Input\n              value={tagValue}\n              onChange={handleInputChange}\n              placeholder=\"Tag Value\"\n            />\n          </Grid>\n        </Grid>\n        <Grid item xs={12}>\n          {Object.entries(tagDetail[\"flags\"]).map(([flagKey, flagValue]) => (\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={(tagValue & flagValue) === flagValue}\n                  onChange={handleFlagChange(flagValue)}\n                  color=\"primary\"\n                />\n              }\n              key={\"flag-\" + flagKey}\n              label={flagKey}\n            />\n          ))}\n        </Grid>\n      </Grid>\n    </Paper>\n  );\n}\n\nexport default Tag;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}